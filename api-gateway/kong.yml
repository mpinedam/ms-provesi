_format_version: "3.0"
_transform: true

services:
  - name: users-service
    url: http://host.docker.internal:8000/api/users
    routes:
      - name: users-route
        paths:
          - /users

  - name: products-service
    url: http://<PRODUCTS_EC2_PRIVATE_IP>:8001/api/products
    routes:
      - name: products-route
        paths:
          - /products
    plugins:
      - name: proxy-cache
        config:
          strategy: memory
          cache_ttl: 30          # tiempo en segundos que se cachea la respuesta
          request_method:
            - GET
          content_type:
            - "application/json"
          memory:
            dictionary_name: kong_cache

  - name: orders-service
    url: http://host.docker.internal:8080/orders
    routes:
      - name: orders-route
        paths:
          - /orders

plugins:
  - name: rate-limiting
    config:
      minute: 10
      policy: local
